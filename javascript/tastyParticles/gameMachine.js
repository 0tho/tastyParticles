"use strict";function GameMachine(t,s,i){this.game=t,this.game.machine=this,this.gameCanvas=document.querySelector(i),this.context=this.gameCanvas.getContext("2d"),this.now,this.ellapsed,this.last,this.fps=s.fps||60,this.dStep=1e3/this.fps,this.accumulator,this.state=STATES.STOPPED,this.width=s.width,this.height=s.height,this.gameCanvas.width=s.width,this.gameCanvas.height=s.height;var h=function(){for(this.now=(new Date).getTime(),this.ellapsed=this.now-this.last,this.last=this.now,this.accumulator+=Math.min(1e3,this.ellapsed);this.accumulator>=this.dStep;)this.game.update(),this.accumulator-=this.dStep;this.game.draw(this.context,this.accumulator),this.state===STATES.PLAYING&&requestAnimationFrame(this.step,this.gameCanvas)};this.last=(new Date).getTime(),this.accumulator=0,this.state=STATES.PLAYING,this.step=h.bind(this)}var STATES={PLAYING:0,STOPPED:1,PAUSED:2};GameMachine.prototype.start=function(){this.step()};